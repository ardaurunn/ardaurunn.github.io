<!DOCTYPE html>
<html>
<head>
  <title>Basic Example</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />
  <link rel="stylesheet" href="src/leaflet.groupedlayercontrol.css" />
  <link rel="stylesheet" href="Leaflet.markercluster-1.4.1/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="Leaflet.markercluster-1.4.1/dist/MarkerCluster.Default.css"/>

</head>


<style>
  * {
        margin: 0;
        padding: 0;
    }

    #map {
        width: 100vw;
        height: 100vh;
    }
</style>


<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>
  <script src="src/leaflet.groupedlayercontrol.js"></script>
  <script src="exampledata.js"></script>
  <script src="leaflet-heat.js"></script>
  <script src="nal-civisi.js"></script>
  <script src="all-finds.js"></script>
  
  <script src="Leaflet.SmoothWheelZoom-master/SmoothWheelZoom.js"></script>
  <script src="Leaflet.markercluster-1.4.1/dist/leaflet.markercluster-src.js"></script>
  <script src="Leaflet.markercluster-1.4.1/dist/leaflet.markercluster.js"></script>
  <script src="Leaflet.markercluster-1.4.1/src/MarkerCluster.js"></script>
  <script src="leaflet.featuregroup.subgroup.js"></script>
  <script src="leaflet.markercluster.layersupport.js"></script>
  
  <script>
    var corner1 = L.latLng(39.30, 42.27),
        corner2 = L.latLng(38.96, 42.90),
        bounds = L.latLngBounds(corner1, corner2);

    var map = L.map('map', {
      center: [39.12, 42.58],
      zoom: 12,
      maxZoom: 16.6,
      minZoom: 11,
      maxBounds: bounds,
      layers: [ExampleData.Basemaps.TopographicBaseMap],
      zoomSnap: 0.25,
      zoomSnap: 0,
      smoothZoom: true,
      smoothZoomDelay: 5000,
      scrollWheelZoom: true, 
      smoothWheelZoom: false,   
      smoothSensitivity: 0.8,   
    }),
      mcgLayerSupportGroup = L.markerClusterGroup.layerSupport(),
      myLayerGroup = L.layerGroup(allfinds);
    
    mcgLayerSupportGroup.addTo(map);
    mcgLayerSupportGroup.checkIn(myLayerGroup); 

    myLayerGroup.addTo(map);  
    
    
    // Calling GeoJSON //
    var heatMapPoints = [];
    var nalCivisiGeoJSON = false;
    fetch("all-finds.geojson", {  
      method: 'GET'
    })
    .then(response => response.json())
    .then(json => {
      json.features.forEach(function(feature) {
        heatMapPoints.push([feature.geometry.coordinates[1], feature.geometry.coordinates[0], 1])
    });


    // Heat Map //
    var heat = L.heatLayer(heatMapPoints, {
      radius: 10,
      minOpacity: 20,
      max: 0.5,
      gradient: {
  '0': 'Red',
  '0.66': 'Yellow',
  '1': 'White'
},
      blur: 30
    }).addTo(map);
    })
    

    // Cluster Map //
    const geojsonMarkerOptions = {
      radius: 8,
      fillOpacity: 0.5
    };

    const lightData = L.geoJSON(allfinds, {
      onEachFeature: function (feature, layer) {
        layer.bindPopup(feature.properties.Name);
      },
      pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, geojsonMarkerOptions);
      },
    });
  
    const mcg = L.markerClusterGroup({
      spiderfyOnMaxZoom: true,
	    showCoverageOnHover: false,
	    zoomToBoundsOnClick: true
    }).addLayer(lightData);

    map.addLayer(mcg);


    


    // Grouped Layer's View //
    var groupedOverlays = {
      "Orthophotos": {
        "1994": ExampleData.LayerGroups.ortho2,
        "1983": ExampleData.LayerGroups.ortho3,
        "1969": ExampleData.LayerGroups.ortho4,
        "1957": ExampleData.LayerGroups.ortho5,
        "1955": ExampleData.LayerGroups.ortho1,
        "Digital Elevation Model": ExampleData.LayerGroups.dem
      },
      "Archaeological Finds": {
        "Ok Ucu": ExampleData.LayerGroups.cities,
        "Nal Ã‡ivisi": ExampleData.LayerGroups.restaurants,
        "Sikke": ExampleData.LayerGroups.restaurants
      },
    };

    L.control.groupedLayers(ExampleData.Basemaps, groupedOverlays).addTo(map);
  </script>
</body>
</html>
